import{r as m,T as x,u as g,j as e,b as w,_ as a}from"./index-BKINKakV.js";import{u as h}from"./formik.esm-DCEU9dEh.js";import{c as f,a as o,b}from"./index.esm-mPjD6bSD.js";function P(){const{decodedToken:l}=m.useContext(x),n=g(),c={token:localStorage.getItem("userToken")},i=f({currentPassword:o().required("Old password is required"),password:o().matches(/^[A-Z][a-z0-9]{3,8}$/,"Password must start with an uppercase letter and contain 3 to 8 lowercase letters or digits").required("New password is required"),rePassword:o().oneOf([b("password")],"Passwords must match").required("Confirm password is required")}),r=h({initialValues:{currentPassword:"",password:"",rePassword:""},onSubmit:async u=>{var t,d;try{const{data:s}=await w.put("https://ecommerce.routemisr.com/api/v1/users/changeMyPassword",u,{headers:c});s?(localStorage.setItem("userToken",s.token),a.success("Password changed successfully",{style:{background:"#22d210",color:"#fff"}}),n("/freshcart/login")):a.error("Failed to change password",{style:{background:"#f15757",color:"#fff"}})}catch(s){console.log(s),a.error(((d=(t=s.response)==null?void 0:t.data)==null?void 0:d.errors.msg)||"An error occurred",{style:{background:"#f15757",color:"#fff"}})}},validationSchema:i});return e.jsx("div",{className:"mt-24 flex items-center justify-center",children:e.jsxs("div",{className:"w-full mb-6 bg-gray-100 shadow-2xl rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"p-6 bg-green-100 border-b border-green-300",children:[e.jsx("h1",{className:"text-4xl font-extrabold text-gray-800 text-center",children:"User Settings"}),e.jsxs("h2",{className:"text-xl font-bold text-gray-800",children:[e.jsx("i",{className:"fa-solid fa-user"})," Hi ",l.name]})]}),e.jsx("div",{className:"p-6 my-6",children:e.jsxs("div",{className:"flex justify-center items-center flex-col max-w-xl m-auto",children:[e.jsx("div",{className:"w-full p-6 bg-green-100 border-b border-green-300",children:e.jsx("h1",{className:"text-4xl font-extrabold text-gray-800 text-center",children:"Change Password"})}),e.jsxs("form",{onSubmit:r.handleSubmit,className:"bg-gray-20 p-8 shadow-xl rounded-lg w-full max-w-xl flex flex-col items-center",children:[e.jsxs("div",{className:"w-full mb-5",children:[e.jsx("label",{htmlFor:"currentPassword",className:"block mb-2 text-sm font-medium text-gray-900",children:"Current  Password"}),e.jsx("input",{name:"currentPassword",type:"password",id:"currentPassword",onBlur:r.handleBlur,onChange:r.handleChange,value:r.values.currentPassword,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-green-500 focus:border-green-500 block w-full p-2.5",placeholder:"Current Password"}),r.touched.currentPassword&&r.errors.currentPassword?e.jsxs("div",{className:"text-sm text-red-800",children:[e.jsx("span",{className:"font-medium",children:"Error:"})," ",r.errors.currentPassword]}):null]}),e.jsxs("div",{className:"w-full mb-5",children:[e.jsx("label",{htmlFor:"password",className:"block mb-2 text-sm font-medium text-gray-900",children:"New Password"}),e.jsx("input",{name:"password",type:"password",id:"password",onBlur:r.handleBlur,onChange:r.handleChange,value:r.values.password,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-green-500 focus:border-green-500 block w-full p-2.5",placeholder:"New Password"}),r.touched.password&&r.errors.password?e.jsxs("div",{className:"text-sm text-red-800",children:[e.jsx("span",{className:"font-medium",children:"Error:"})," ",r.errors.password]}):null]}),e.jsxs("div",{className:"w-full mb-5",children:[e.jsx("label",{htmlFor:"rePassword",className:"block mb-2 text-sm font-medium text-gray-900",children:"Confirm Password"}),e.jsx("input",{name:"rePassword",type:"password",id:"rePassword",onBlur:r.handleBlur,onChange:r.handleChange,value:r.values.rePassword,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-green-500 focus:border-green-500 block w-full p-2.5",placeholder:"Confirm Password"}),r.touched.rePassword&&r.errors.rePassword?e.jsxs("div",{className:"text-sm text-red-800",children:[e.jsx("span",{className:"font-medium",children:"Error:"})," ",r.errors.rePassword]}):null]}),e.jsx("button",{type:"submit",className:"w-full h-12 bg-green-400 text-white font-medium rounded-lg hover:bg-green-500 focus:ring-4 focus:outline-none focus:ring-green-300 text-sm px-5 py-2.5",children:"Submit"})]})]})})]})})}export{P as default};
