import{r as n,U as v,u as S,j as e,b,_ as u}from"./index-D1X4h8q3.js";import{u as x}from"./formik.esm-DoeA6Vb4.js";import{l as w}from"./Loader-DLhe4uCz.js";function k(){const[l,i]=n.useState(!1),{setuserlogin:c}=n.useContext(v),d=S(),s=x({initialValues:{email:"",newPassword:""},onSubmit:async f=>{try{const{data:r}=await b.put("https://ecommerce.routemisr.com/api/v1/auth/resetPassword",f);r&&(c(r.token),u.success("Password changed successfully",{style:{background:"#22d210",color:"#fff"}}),d("/freshcart/login")),r.statusMsg==="success"?console.log("Password reset successful"):console.log()}catch(r){u.error(r.response.data.message,{style:{background:"#f15757",color:"#fff"}})}finally{}}});return l?e.jsx(w,{}):e.jsx("div",{className:"flex justify-center items-center",children:e.jsxs("form",{onSubmit:s.handleSubmit,className:"bg-glass p-8 shadow-lg rounded-lg w-full max-w-md flex flex-col items-center gap-6",children:[e.jsx("p",{className:"text-center text-2xl font-bold text-blue-800",children:"New Password"}),e.jsxs("div",{className:"w-full mb-5",children:[e.jsx("label",{htmlFor:"email",className:"block mb-2 text-sm font-medium text-gray-900",children:"Your email"}),e.jsx("input",{name:"email",type:"email",id:"email",onBlur:s.handleBlur,onChange:s.handleChange,value:s.values.email,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",placeholder:"name@mail.com"})]}),e.jsxs("div",{className:"w-full mb-5",children:[e.jsx("label",{htmlFor:"newPassword",className:"block mb-2 text-sm font-medium text-gray-900",children:"Your New Password"}),e.jsx("input",{name:"newPassword",type:"password",id:"newPassword",onBlur:s.handleBlur,onChange:s.handleChange,value:s.values.newPassword,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",placeholder:"Your new password"})]}),e.jsx("button",{type:"submit",className:"w-full h-12 bg-blue-700 text-white font-medium rounded-lg hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 text-sm px-5 py-2.5",children:"Submit"})]})})}function P(){const[l,i]=n.useState(""),[c,d]=n.useState(null),[g,s]=n.useState(null),r=x({initialValues:{resetCode:""},onSubmit:async a=>{try{const{data:t}=await b.post("https://ecommerce.routemisr.com/api/v1/auth/verifyResetCode",JSON.stringify({resetCode:a.resetCode}),{headers:{"Content-Type":"application/json"}});t.status=="Success"?(u.success("Type the email then the new password",{style:{background:"#22d210",color:"#fff"}}),d(!0)):console.error("Failed to reset password:",t)}catch(t){console.error("An error occurred. Please try again.",t),u.error(t.response.data.message,{style:{background:"#f15757",color:"#fff"}})}finally{}}}),j=(a,t)=>{const{value:o}=t.target;if(!/^\d$/.test(o)&&o!=="")return;const m=l.substring(0,a)+o+l.substring(a+1);if(i(m),r.setFieldValue("resetCode",m),o&&a<5){const p=document.getElementById(`otp-input${a+1}`);p&&p.focus()}},N=(a,t)=>{if(t.key==="Backspace"&&!t.target.value&&a>0){const o=document.getElementById(`otp-input${a-1}`);if(o){const m=l.substring(0,a-1)+l.substring(a);i(m),r.setFieldValue("resetCode",m),o.focus()}}};if(c)return e.jsx(k,{});function h(){s(!0)}return g?e.jsx(y,{}):e.jsx("div",{className:"flex justify-center items-center p-4",children:e.jsxs("div",{className:"bg-glass p-8 shadow-lg rounded-lg w-full max-w-md flex flex-col items-center gap-6 relative",children:[e.jsx("span",{className:"text-xl font-bold text-black",children:"Enter verification code"}),e.jsx("p",{className:"text-sm text-black text-center leading-5",children:"We have sent a verification code to your Email"}),e.jsxs("form",{onSubmit:r.handleSubmit,children:[e.jsx("div",{className:"w-full flex flex-row gap-2 items-center justify-center ",children:[...Array(6)].map((a,t)=>e.jsx("input",{id:`otp-input${t}`,value:l[t]||"",maxLength:"1",type:"text",onChange:o=>j(t,o),onKeyDown:o=>N(t,o),className:"bg-glass w-12 h-12 text-center border-none rounded-md caret-indigo-500 text-gray-800 outline-none font-semibold focus:bg-indigo-100 transition duration-300"},t))}),e.jsx("button",{type:"submit",className:"w-full h-12 mt-4 bg-indigo-500 text-white font-semibold rounded-md hover:bg-indigo-400 transition duration-200",children:"Verify"})]}),e.jsx("button",{onClick:h,className:"absolute  top-4 right-4 bg-red-700 text-white text-black text-lg rounded-full w-8 h-8 border-none shadow-md flex items-center justify-center cursor-pointer",children:"Ã—"}),e.jsxs("p",{className:"text-sm text-black w-full flex flex-col items-center justify-center gap-1",children:["Not Your Email ?",e.jsx("button",{onClick:h,className:"bg-transparent border-none text-indigo-500 text-lg font-semibold cursor-pointer",children:"Change Email"})]})]})})}function y(){const[l,i]=n.useState(!1),[c,d]=n.useState(!1),s=x({initialValues:{email:""},onSubmit:async f=>{i(!0);try{const{data:r}=await b.post("https://ecommerce.routemisr.com/api/v1/auth/forgotPasswords",f);r.statusMsg==="success"&&(d(!0),u.success(r.message,{style:{background:"#22d210",color:"#fff"}}))}catch{u.error("An error occurred. Please try again.",{style:{background:"#f15757",color:"#fff"}})}finally{i(!1)}}});return l?e.jsx(w,{}):c?e.jsx(P,{}):e.jsx("div",{className:"flex justify-center items-center",children:e.jsxs("form",{onSubmit:s.handleSubmit,className:"bg-glass p-8 shadow-lg rounded-lg w-full max-w-md flex flex-col items-center gap-6",children:[e.jsx("p",{className:"text-center text-2xl font-bold text-blue-800",children:"Reset Password"}),e.jsxs("div",{className:"w-full mb-5",children:[e.jsx("label",{htmlFor:"email",className:"block mb-2 text-sm font-medium text-gray-900",children:"Your email"}),e.jsx("input",{name:"email",type:"email",id:"email",onBlur:s.handleBlur,onChange:s.handleChange,value:s.values.email,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",placeholder:"Email@mail.com"})]}),e.jsx("button",{type:"submit",className:"w-full h-12 bg-blue-700 text-white font-medium rounded-lg hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 text-sm px-5 py-2.5",children:"Submit"})]})})}const B=Object.freeze(Object.defineProperty({__proto__:null,default:y},Symbol.toStringTag,{value:"Module"}));export{P as O,B as R};
