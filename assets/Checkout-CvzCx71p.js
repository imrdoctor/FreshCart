import{r as l,c as x,u as y,j as e,b as d,_ as o}from"./index-BJfZhxjA.js";import{u as k}from"./formik.esm-BnRfUuCf.js";import{c as v,a as j}from"./index.esm-rkF845Nz.js";import{l as w}from"./Loader-DPb39At9.js";import{O as N}from"./ResetPassword-DGghqQzH.js";function $(){const[u,n]=l.useState(!1),[m,C]=l.useState(!1);let{pymintid:c}=x();const[i,h]=l.useState(!1),f=y(),g=s=>{h(s.target.checked)},b=async s=>{n(!0);try{let a,t;i?(a=await d.post(`https://ecommerce.routemisr.com/api/v1/orders/${c}`,s,{headers:{token:localStorage.getItem("userToken")}}),a.data.status==="success"?(f("/allorders"),console.log("Cash on delivery order processed successfully",a.data)):o.error("An error occurred while processing cash on delivery.",{style:{background:"#f15757",color:"#fff"}})):(t=await d.post(`https://ecommerce.routemisr.com/api/v1/orders/checkout-session/${c}?url=https://imrdoctor.github.io/freshcart`,s,{headers:{token:localStorage.getItem("userToken")}}),t.data.status==="success"?(console.log("Online payment session created successfully"),window.location.href=t.data.session.url):o.error("An error occurred while processing online payment.",{style:{background:"#f15757",color:"#fff"}}))}catch{o.error("An error occurred. Please try again.",{style:{background:"#f15757",color:"#fff"}})}finally{n(!1)}},p=v({phone:j().matches(/^01[0125][0-9]{8}$/,"Invalid phone number")}),r=k({initialValues:{details:"",phone:"",city:""},onSubmit:b,validationSchema:p});return u?e.jsx(w,{}):m?e.jsx(N,{}):e.jsx("div",{className:"flex justify-center items-center",children:e.jsxs("form",{onSubmit:r.handleSubmit,className:"bg-glass p-8 shadow-lg rounded-lg w-full max-w-md flex flex-col items-center gap-6",children:[e.jsx("p",{className:"text-center text-2xl font-bold text-blue-800",children:"Your Address"}),e.jsxs("div",{className:"w-full",children:[e.jsx("label",{htmlFor:"email",className:"block mb-1 text-sm font-medium text-gray-900",children:"Your City"}),e.jsx("input",{name:"city",type:"text",id:"city",onBlur:r.handleBlur,onChange:r.handleChange,value:r.values.city,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",placeholder:"Type Your City",required:!0})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("label",{htmlFor:"phone",className:"block mb-1 text-sm font-medium text-gray-900",children:"Your phone"}),e.jsx("input",{name:"phone",type:"tel",id:"phone",onBlur:r.handleBlur,onChange:r.handleChange,value:r.values.phone,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",placeholder:"Type Your Phone ",required:!0}),r.touched.phone&&r.errors.phone?e.jsxs("div",{className:"mb-2 mb-0 text-sm text-red-800",children:[e.jsx("span",{className:"font-medium",children:"Error:"})," ",r.errors.phone]}):null]}),e.jsxs("div",{className:"w-full",children:[e.jsx("label",{htmlFor:"details",className:"block mb-1 text-sm font-medium text-gray-900",children:"Your details"}),e.jsx("input",{name:"details",type:"text",id:"details",onBlur:r.handleBlur,onChange:r.handleChange,value:r.values.details,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",placeholder:"Type Any details you want ",required:!0})]}),e.jsxs("div",{className:"flex w-full px-2",children:[e.jsx("input",{id:"default-checkbox",type:"checkbox",value:"",checked:i,onChange:g,className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"})," ",e.jsx("label",{htmlFor:"default-checkbox",className:"ms-2 text-sm font-medium text-gray-900 dark:text-gray-300",children:"Cash on delivery?"})]}),e.jsxs("button",{disabled:!(r.isValid&&r.dirty),type:"submit",className:`w-full h-12 bg-blue-700 text-white font-medium rounded-lg hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 text-sm px-5 py-2.5 ${r.isValid&&r.dirty?"":"opacity-50 cursor-not-allowed"}`,children:[e.jsx("i",{className:"fa-regular fa-credit-card"})," Pay"]})]})})}export{$ as default};
