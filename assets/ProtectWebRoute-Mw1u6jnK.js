import{r as s,U as m,u as h,j as l,v,b as x}from"./index-IpT9UOtb.js";import{l as k}from"./Loader-OmA2CF2o.js";function I(c){const{setuserlogin:r}=s.useContext(m),e=h(),[u,t]=s.useState(null),[f,a]=s.useState(!0);return s.useEffect(()=>{const n=localStorage.getItem("userToken");async function g(){var i;if(!n){t(!1),a(!1),e("/freshcart/login");return}const d={token:n};try{(await x.get("https://ecommerce.routemisr.com/api/v1/auth/verifyToken",{headers:d})).data.message==="verified"?(console.log("Your Token Is Real"),t(!0)):(console.log("Invalid Token, redirecting to login"),t(!1),e("/freshcart/login"))}catch(o){console.error("Error verifying token:",((i=o.response)==null?void 0:i.data)||o.message),t(!1),localStorage.removeItem("userToken"),r(null),e("/freshcart/login")}finally{a(!1)}}g()},[e,r]),f?l.jsx(k,{}):u?c.children:l.jsx(v,{to:"/freshcart/login"})}export{I as default};
