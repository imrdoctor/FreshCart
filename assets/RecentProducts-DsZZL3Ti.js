import{r as e,W as C,C as w,j as r,_ as a,b as P}from"./index-BJfZhxjA.js";import{u as j}from"./useQuery-Dcy7Iqgi.js";import{l as v}from"./Loader-DPb39At9.js";import{P as T}from"./ProductItem-C38CUdK8.js";function E(){const{wishList:i,removeItem:c,addtoWashList:d}=e.useContext(C),{addProductToCart:l}=e.useContext(w),[u,n]=e.useState(!1),[f,m]=e.useState(null);e.useState(i);function g(){return P.get("https://ecommerce.routemisr.com/api/v1/products")}const{data:o,isError:x,error:W,isLoading:h,isFetching:b}=j({queryKey:["recentProducts"],queryFn:g});if(h)return r.jsx(v,{});if(x)return r.jsx("div",{className:"text-center text-red-500 text-2xl mt-10",children:r.jsx("p",{children:"Something went wrong"})});async function y(t){n(!0),m(t);try{let s=await l(t);s&&s.status===200?a.success(s.data.message,{style:{background:"#22d210",color:"#fff"}}):s.response.data.message=="Invalid Token. please login again"&&a.error("Login First To Add Product To Cart",{style:{background:"#f15757",color:"#fff"}})}catch{console.log("error","=",err.data),a.error("An error occurred while adding product to cart. Please try again later.",{style:{background:"#f15757",color:"#fff"}})}finally{n(!1)}}function p(t){console.log(t),d(t)}function L(t){console.log(t),c(t)}return r.jsx("div",{className:"row mt-10 mt-16",children:o==null?void 0:o.data.data.map(t=>r.jsx(T,{product:t,loading:u,cruntid:f,addToCart:y,AddWishList:()=>p(t.id),removewashList:()=>L(t.id)},t.id))})}export{E as R};
